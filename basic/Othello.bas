0100 REM  *** OTHELLO ***
0110 REM  *** (C)1984 ***
0120 CLEAR :HOME 
0130 DIM A(8,8),P(20),Q(20,2)
0140 FOR Y=1TO 8:FOR Z=1TO 8:A(Y,Z)=0:NEXT Z:NEXT Y
0150 CALL SCREEN(1)
0160 FOR I=0TO 31:CALL CHRCOL(I,7,1):NEXT 
0170 GOTO 200
0180 HOME :?"********** OTHELLO **********"
0190 ?:RETURN 
0200 GOSUB 180
0210 ?:?:INPUT "SPELREGELS (J/N) : ",A$
0220 IF A$="J"GOSUB 180ELSE GOTO 310
0230 ?"VERSLA UW TEGENSTANDER D.M.V. MEER GEPLAATSTE VELDEN."
0240 ?:?"VELDEN KUNT U BEZETTEN DOOR EREEN 'STEEN' OP TE PLAATSEN."
0250 ?:?"ONDER VOORWAARDE DAT MEER DAN 0 VELDEN DER TEGENPARTIJ  HOR.OF VERT. OF DIAG. WORDT/WORDENINGESLOTEN."
0260 ?:?"HET EINDE VAN HET SPEL IS ALS:-ALLE 64 VELDEN BEZET ZIJN    -1 VAN U GEEN VELD MEER HEEFT"
0270 ?"-'DE STROOM UITVALT',ETC."
0280 ?:?"U SPEELT MET '";CHR$(142);"' ,DE COMPUTER MET'";CHR$(140);"'."
0290 ?:?:?"GELEZEN (J) ?"
0300 IF ASC( INKEY$* )<> 74GOTO 300
0310 GOSUB 180:?:?:INPUT "SPELVOORBEELDEN (J/N) : ",A$
0315 IF A$="J"GOTO 6000
0320 GOSUB 180:?:?:INPUT "MOELYKHEIDSGRAAD 1 2 3 OF 4 ",M$
0330 GOSUB 180:?:?:?"HET IS EEN LANGZAAM DENKEND   SPEL.":FOR Y=1TO 1000:NEXT Y
0340 A(4,4)=1:A(4,5)=2:A(5,4)=2:A(5,5)=1:Z=Z1
0350 GOTO 1000
0360 HOME :NUL=0
0370 ?"   1 2 3 4 5 6 7 8"
0380 FOR Y=1TO 8
0390 ?"   ---------------"
0400 ?Y;"-";
0410 FOR Q=1TO 8
0420 ?":";
0430 IF A(Y,Q)=0THEN ?" ";:NUL=NUL+1
0440 IF A(Y,Q)=1THEN ?CHR$( 142);
0450 IF A(Y,Q)=2THEN ?CHR$( 140);
0460 IF A(Y,Q)=9THEN ?"*";
0470 NEXT Q
0480 ?":-";Y
0490 NEXT Y
0500 ?"   ---------------"
0510 ?"   1 2 3 4 5 6 7 8"
0520 ?
0530 IF NUL=0GOTO 1340
0540 RETURN 
1000 GOSUB 360
1010 RF=0:?"10,1=OPGEVEN 9,9=OVERSLAAN"
1020 INPUT "VERT-RIJ : ",B:INPUT " HOR-RIJ : ",C:?
1040 IF B=9AND C=9THEN RF=1:GOTO 1110
1050 IF B=10AND C=1GOTO 5000
1060 IF A(B,C)<> 0GOTO 1000ELSE A(B,C)=9:GOSUB 360
1070 INPUT "'*' IS UW ZET,IS HET ZO GOED  (J/N) ",A$:IF A$<> "J"THEN A(B,C)=0:GOTO 1000
1080 A(B,C)=1:TT=0:G=1:GOSUB 3000
1090 IF TT=0THEN A(B,C)=0:GOTO 1000
1100 GOSUB 360:?
1110 G=2:T2=0:T1=0
1120 FOR B=8TO 1STEP -1:FOR C=8TO 1STEP -1
1130 IF NOT A(B,C)=0GOTO 1300ELSE GOSUB 2000
1140 IF YX=1GOTO 1300ELSE T=3:TT=0:GOSUB 3000
1150 IF TT=0GOTO 1300
1160 IF M$="3"OR M$="4"GOTO 7050
1170 IF TT>6OR TT<= T1OR M$="1"GOTO 1270
1180 IF M$="4"GOTO 7100
1190 IF B=1AND C=2AND A(1,1)<> 2GOTO 7000
1200 IF B=1AND C=7AND A(1,8)<> 2GOTO 7000
1210 IF B=2AND (C=1OR C=2)AND A(1,1)<> 2GOTO 7000
1220 IF B=2AND (C=7OR C=8)AND A(1,8)<> 2GOTO 7000
1230 IF B=7AND (C=1OR C=2)AND A(8,1)<> 2GOTO 7000
1240 IF B=7AND (C=7OR C=8)AND A(8,8)<> 2GOTO 7000
1250 IF B=8AND C=2AND A(8,1)<> 2GOTO 7000
1260 IF B=8AND C=7AND A(8,8)<> 2GOTO 7000
1270 IF M$="3"OR M$="4"GOTO 1290
1280 IF (B=1AND C=1)OR (B=8AND C=8)OR (B=1AND C=8)OR (B=8AND C=1)THEN TT=TT+6
1290 IF TT>T1THEN T1=TT:V=B:H=C
1300 NEXT C:?B;:NEXT B
1310 B=V:C=H:T=0
1320 IF T1=0AND RF=1GOTO 5030
1330 IF T1=0GOTO 1340ELSE GOSUB 3000:A(B,C)=G
1340 Z=0:Z1=0:NUL=0
1350 FOR Y=1TO 8
1360 FOR X=1TO 8
1370 IF A(Y,X)=1THEN Z=Z+1
1380 IF A(Y,X)=2THEN Z1=Z1+1
1390 IF A(Y,X)=0THEN NUL=NUL+1
1400 NEXT X:NEXT Y
1410 IF NUL=0OR Z=0OR Z1=0GOTO 5030
1420 ?CHR$( 12)
1430 ?"U HEEFT ER:";Z:?"IK HEB ER:";Z1
1440 FOR Y=1TO 800:NEXT Y:GOTO 1000
2000 F=B-1:L=C-1:YX=0
2010 IF L<1THEN GOTO 2030
2020 IF A(B,L)=1GOTO 2210
2030 IF F<1THEN GOTO 2070
2040 IF A(F,C)=1GOTO 2210
2050 IF L<1GOTO 2070
2060 IF A(F,L)=1GOTO 2210
2070 L=C+1
2080 IF L>8THEN GOTO 2120
2090 IF A(B,L)=1GOTO 2210
2100 IF F<1GOTO 2120
2110 IF A(F,L)=1GOTO 2210
2120 F=B+1
2130 IF F>8GOTO 2200
2140 IF A(F,C)=1GOTO 2210
2150 IF L>8THEN GOTO 2170
2160 IF A(F,L)=1GOTO 2210
2170 L=C-1
2180 IF L<1GOTO 2200
2190 IF A(F,L)=1GOTO 2210
2200 YX=1
2210 RETURN 
3000 GH=0:JI=0
3010 FOR Y=1TO 7
3020 F=B-Y
3030 IF F<1THEN GOTO 3060
3040 IF A(F,C)=0OR A(F,C)=GTHEN JI=1
3050 IF JI<> 1THEN GH=Y
3060 NEXT Y
3070 IF GH=0OR (B-GH)-1<1THEN GOTO 3140
3080 F=B-(GH+1)
3090 IF NOT A(F,C)=GGOTO 3140
3100 FOR X=1TO GH
3110 F=B-X
3120 TT=TT+1:IF T<> 3THEN A(F,C)=G
3130 NEXT X
3140 GH=0:JI=0
3150 FOR Y=1TO 7
3160 F=B-Y:L=C-Y
3170 IF F<1OR L<1THEN GOTO 3200
3180 IF A(F,L)=0OR A(F,L)=GTHEN JI=1
3190 IF JI<> 1THEN GH=Y
3200 NEXT Y
3210 F=B-(GH+1):L=C-(GH+1)
3220 IF GH=0OR F<1OR L<1THEN GOTO 3290
3230 IF NOT A(F,L)=GGOTO 3290
3240 FOR X=1TO GH
3250 F=B-X:L=C-X
3260 TT=TT+1
3270 IF T<> 3THEN A(F,L)=G
3280 NEXT X
3290 GH=0:JI=0
3300 FOR Y=1TO 7
3310 F=B-Y:L=C+Y
3320 IF F<1OR L>8THEN GOTO 3350
3330 IF A(F,L)=0OR A(F,L)=GTHEN JI=1
3340 IF JI<> 1THEN GH=Y
3350 NEXT Y
3360 F=B-(GH+1):L=C+(GH+1)
3370 IF GH=0OR F<1OR L>8THEN GOTO 3440
3380 IF NOT A(F,L)=GOR L>8GOTO 3440
3390 FOR X=1TO GH
3400 F=B-X:L=C+X
3410 TT=TT+1
3420 IF T<> 3THEN A(F,L)=G
3430 NEXT X
3440 GH=0:JI=0
3450 FOR Y=1TO 7
3460 L=C-Y
3470 IF L<1THEN GOTO 3500
3480 IF A(B,L)=0OR A(B,L)=GTHEN JI=1
3490 IF JI<> 1THEN GH=Y
3500 NEXT Y
3510 L=C-(GH+1)
3520 IF GH=0OR L<1OR A(B,L)<> GTHEN GOTO 3580
3530 FOR X=1TO GH
3540 L=C-X
3550 TT=TT+1
3560 IF T<> 3THEN A(B,L)=G
3570 NEXT X
3580 GH=0:JI=0
3590 FOR Y=1TO 7
3600 L=C+Y
3610 IF L>8THEN GOTO 3640
3620 IF A(B,L)=0OR A(B,L)=GTHEN JI=1
3630 IF JI<> 1THEN GH=Y
3640 NEXT Y
3650 L=C+(GH+1)
3660 IF GH=0OR L>8THEN GOTO 3730
3670 IF A(B,L)<> GTHEN GOTO 3730
3680 FOR X=1TO GH
3690 L=C+X
3700 TT=TT+1
3710 IF T<> 3THEN A(B,L)=G
3720 NEXT X
3730 GH=0:JI=0
3740 FOR Y=1TO 7
3750 F=B+Y
3760 IF F>8THEN GOTO 3790
3770 IF A(F,C)=0OR A(F,C)=GTHEN JI=1
3780 IF JI<> 1THEN GH=Y
3790 NEXT Y
3800 F=B+(GH+1)
3810 IF GH=0OR F>8THEN GOTO 3880
3820 IF A(F,C)<> GTHEN GOTO 3880
3830 FOR X=1TO GH
3840 TT=TT+1
3850 F=B+X
3860 IF T<> 3THEN A(F,C)=G
3870 NEXT X
3880 GH=0:JI=0
3890 FOR Y=1TO 7
3900 F=B+Y:L=C-Y
3910 IF F>8OR L<1THEN GOTO 3940
3920 IF A(F,L)=0OR A(F,L)=GTHEN JI=1
3930 IF JI<> 1THEN GH=Y
3940 NEXT Y
3950 F=B+(GH+1):L=C-(GH+1)
3960 IF GH=0OR F>8OR L<1THEN GOTO 4030
3970 IF A(F,L)<> GTHEN GOTO 4030
3980 FOR X=1TO GH
3990 TT=TT+1
4000 F=B+X:L=C-X
4010 IF T<> 3THEN A(F,L)=G
4020 NEXT X
4030 GH=0:JI=0
4040 FOR Y=1TO 7
4050 F=B+Y:L=C+Y
4060 IF F>8OR L>8THEN GOTO 4090
4070 IF A(F,L)=0OR A(F,L)=GTHEN JI=1
4080 IF JI<> 1THEN GH=Y
4090 NEXT Y
4100 F=B+(GH+1):L=C+(GH+1)
4110 IF GH=0OR F>8OR L>8THEN GOTO 4180
4120 IF A(F,L)<> GTHEN GOTO 4180
4130 FOR X=1TO GH
4140 F=B+X:L=C+X
4150 TT=TT+1
4160 IF T<> 3THEN A(F,L)=G
4170 NEXT X
4180 RETURN 
5000 ?CHR$( 12)
5010 GOSUB 180:?:?"BEDANKT VOOR HET SPEL"
5030 IF Z1>ZGOTO 5110
5040 IF Z=Z1THEN ?"GELIJKSPEL!":GOTO 5070
5050 ?CHR$( 12);"U HEEFT GEWONNEN!!!!"
5060 ?"MET ";ABS{ Z-Z1);" STENEN VERSCHIL"
5070 REM 
5080 INPUT "NOG EEN KEER (J/N) ",A$
5090 IF A$="J"GOTO 100
5100 GOTO 5000
5110 ?CHR$( 12);"U HEEFT VERLOREN!!!!"
5120 GOTO 5060
6000 REM  SPELVOORBEELD
6010 A(4,4)=1:A(4,5)=2:A(5,4)=2:A(5,5)=1
6020 GOSUB 360
6030 ?"DIT IS DE BEGINOPSTELLING."
6040 ?"'";CHR$( 140);"' ZET :4,3";TAB( 26);:INPUT "=> ",A$
6050 A(4,3)=2:A(4,4)=2
6060 GOSUB 360
6070 ?"TEGENZET VAN '";CHR$( 142);"' IS:3,3";
6080 ?TAB( 26);:INPUT "=> ",A$
6090 A(3,3)=1:A(4,4)=1
6100 GOSUB 360
6110 ?"'";CHR$( 140);"' ZET NU :3,4";TAB( 26);
6120 INPUT "=> ",A$
6130 A(3,4)=2:A(4,4)=2
6140 GOSUB 360
6150 ?"'";CHR$( 142);"' ZET 3,5 EN PAKT 2 STENEN.";
6160 ?TAB( 26);:INPUT "=> ",A$
6170 A(3,5)=1:A(3,4)=1:A(4,5)=1
6180 GOSUB 360
6190 ?"EN ZO VERDER TOT HET HELE VELDVOL IS,SUCCES !!"
6200 FOR W=1TO 500:NEXT W:A$=CHR$( 1)
6210 FOR Y=1TO 8:FOR Z=1TO 8:A(Y,Z)=0:NEXT Z:NEXT Y
6220 GOTO 320
7000 IF TT<= T2GOTO 1300
7010 IF T1>= .6GOTO 1300
7020 T1=.5:V=B
7030 T2=TT:H=C
7040 GOTO 1300
7050 IF B=1AND NOT (C=2OR C=7)THEN TT=TT+3
7060 IF C=1AND NOT (B=2OR C=7)THEN TT=TT+3
7070 IF B=8AND NOT (C=2OR C=7)THEN TT=TT+3
7080 IF C=8AND NOT (B=2OR B=7)THEN TT=TT+3
7090 GOTO 1170
7100 IF B=2AND NOT (C=1OR C=2OR C=7OR C=8)THEN TT=TT-.4
7110 IF C=2AND NOT (B=1OR B=2OR B=7OR B=8)THEN TT=TT-.4
7120 IF B=7AND NOT (C=1OR C=2OR C=7OR C=8)THEN TT=TT-.4
7130 IF C=7AND NOT (B=1OR B=2OR B=7OR B=8)THEN TT=TT-.4
7140 GOTO 1190
