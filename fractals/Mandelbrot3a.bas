0010 REM MANDELBROT V0.3a (2022)
0020 GOSUB 9000:GOTO 1000
0030 X=X0:Y=Y0:K=0
0040 Z=X:X=X*X-Y*Y+X0:Y=2*Y*Z+Y0
0050 IF X*X+Y*Y>DIGOTO 70
0060 K=K+1:IF K<NIGOTO 40
0070 CC=K+1:X0=X0+XS:RETURN
0990 REM *** MAIN LOOP
1000 FOR J=0TO 95
1010 X0=XB:PLOT 191,0,15TO 191,J*255/96
1020 FOR I=0TO 248 STEP 8
1030 H=0:TC=0
1040 GOSUB 30
1050 IF CC<2OR CC>NIGOTO 1200
1060 TC=TC+CC
1070 IF H=3THEN C=TC/4
1080 H=H+1:IF H<8GOTO 1040
1090 CC=TC/4-C:P=15
1100 GOTO 1500
1200 N=H:P=B(H)
1210 H=H+1:IF H=8GOTO 1250
1220 GOSUB 30
1230 IF CC<2OR CC>NITHEN P=P+B(H)ELSE TC=TC+CC:N=N+1
1240 GOTO 1210
1250 IF N=0GOTO 1530
1260 C=TC/N:CC=0
1500 H0=I
1510 V0=95-J:GOSUB 2000
1520 V0=95+J:GOSUB 2000
1530 NEXT I
1540 Y0=Y0+YS:NEXT J
1550 PLOT 191,0,1TO 191,255:PRINT CHR$(7);
1560 GOTO 1560
1950 REM ****************
1960 REM VDP WRITE:
1970 REM PATTERN P
1980 REM COLOR FG*16+BG
1990 REM ****************
2000 BH=INT(V0/8):BL=INT(H0/8)*8+(V0-BH*8)
2010 OUT 191,BL:OUT 191,BH+64
2020 OUT 190,P
2030 OUT 191,BL:OUT 191,BH+96
2040 OUT 190,PA(CC)*16+PA(C)
2050 RETURN
8000 REM ****************
8010 REM SEE MSX MAGAZINE
8020 REM NR.25 - SEP 1988
8030 REM
8040 REM + COLOR PALETTE
8050 REM + X RESOLUTION
8060 REM + OPTIMIZATION
8070 REM ****************
9000 RESTORE 9210
9010 DIM PA(16)
9020 FOR I=1TO 16
9030 READ PA(I)
9040 NEXT I
9050 X1=-2.05:X2=0.7
9060 Y1=-1.18:Y2=1.18
9070 S1=256: REM SCREEN WIDTH (SCALE)
9080 NI=15:DI=4
9090 XB=X1:XS=(X2-X1)/256:YB=0:YS=(Y2-Y1)/192
9100 DIM B(7):B(0)=128:B(1)=64:B(2)=32:B(3)=16:B(4)=8:B(5)=4:B(6)=2:B(7)=1
9110 CALL SCREEN(1,1)
9120 PLOT 191,255,15
9130 RETURN
9200 REM COLOR PALETTE:
9210 DATA 1,6,8,9,10,11,3,2,12,4,5,7,13,14,15,1
